<!doctype html>
<html lang="es">
  <head>
    <title>Peaje</title>
    <meta charset="utf-8" />

    <script defer src="/js/main.js"></script>
  </head>
  <body>
    <span id="points"> ??? </span>
    <button>Alternar</button>
    <span id="span"> ??? </span>

    <script>
      const span = document.querySelector("#span");

      let isOpen = true;
      document.querySelector("button").addEventListener("click", (_) => {
        if (isOpen) {
          fetch("/_/close");
          isOpen = false;
          span.innerText = "Cerrado";
          return;
        }

        fetch("/_/open");
        isOpen = true;
        span.innerText = "Abierto";
      });

      const points = document.querySelector("#points");

      function showPoints() {
        fetch("/_/info")
          .then((data) => data.json())
          .then((data) => {
            console.log(data);
            points.innerText = `Points: ${data.Points}`;
            setTimeout(showPoints, 500);
          })
          .catch((err) => {
            console.log(err);
            setTimeout(showPoints, 500);
          });
      }

      showPoints();
    </script>
  </body>
</html>
